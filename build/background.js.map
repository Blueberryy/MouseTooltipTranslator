{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/is-alphabetical/index.js","webpack:///./node_modules/is-decimal/index.js","webpack:///./node_modules/is-alphanumerical/index.js","webpack:///./node_modules/bcp-47/lib/regular.js","webpack:///./node_modules/bcp-47/lib/normal.js","webpack:///./node_modules/bcp-47/lib/parse.js","webpack:///./src/setting.js","webpack:///./src/background.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isAlphabetical","character","code","charCodeAt","isDecimal","isAlphanumerical","regular","normal","own","lang","defaultList","useTooltip","useTTS","translateWhen","translateSource","translateTarget","parse","tag","options","start","groups","offset","settings","result","language","extendedLanguageSubtags","script","region","variants","extensions","privateuse","irregular","source","String","toLowerCase","index","Error","undefined","normalize","includes","slice","fail","push","singleton","charAt","split","length","reason","warning","forgiving","navigator","translatorVendor","keyDownTooltip","keyDownTTS","detectType","translateReverseTarget","tooltipFontSize","tooltipWidth","detectPDF","useOCR","ocrDetectionLang","historyList","historyRecordActions","getSettingFromStorage","Promise","resolve","reject","chrome","storage","local","keys","loadedSetting","currentSetting","settingLoaded","bingLangCode","auto","af","am","ar","az","bg","bs","ca","cs","cy","da","de","el","en","es","et","fa","fi","fr","ga","gu","hi","hmn","hr","ht","hu","hy","id","is","it","iw","ja","kk","km","kn","ko","ku","lo","lt","lv","mg","mi","ml","mr","ms","mt","my","ne","nl","no","pa","pl","ps","pt","ro","ru","sk","sl","sm","sq","sr","sv","sw","ta","te","th","tl","tr","uk","ur","vi","bingLangCodeOpposite","json","ret","swap","saveSetting","inputSettings","set","async","getSetting","bingAccessToken","runtime","onMessage","addListener","request","sender","sendResponse","type","translatedText","detectedLang","word","targetLang","res","postMessage","q","sentences","forEach","trans","src","translateWithGoogle","token","IG","IID","Date","now","data","fetch","then","response","text","match","_key","_token","interval","_isVertical","_isAuthv2","JSON","tokenTs","tokenExpiryInterval","isAuthv2","count","e","console","log","getBingAccessToken","fromLang","to","translateWithBing","sourceLang","error","doTranslate","voice","voiceList","tts","getVoices","voices","filtered","filter","remote","voiceName","item","sort","x","y","speak","doTts","stop","unshift","sourceText","targetText","pop","recordHistory","url","params","URLSearchParams","method","catch","err"],"mappings":"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","file":"background.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n","/**\r\n * Check if the given character code, or the character code at the first\r\n * character, is alphabetical.\r\n *\r\n * @param {string|number} character\r\n * @returns {boolean} Whether `character` is alphabetical.\r\n */\r\nexport function isAlphabetical(character) {\r\n  var code = typeof character === 'string' ? character.charCodeAt(0) : character\r\n\r\n  return (\r\n    (code >= 97 && code <= 122) /* a-z */ ||\r\n    (code >= 65 && code <= 90) /* A-Z */\r\n  )\r\n}\r\n","/**\r\n * Check if the given character code, or the character code at the first\r\n * character, is decimal.\r\n *\r\n * @param {string|number} character\r\n * @returns {boolean} Whether `character` is a decimal\r\n */\r\nexport function isDecimal(character) {\r\n  var code = typeof character === 'string' ? character.charCodeAt(0) : character\r\n\r\n  return code >= 48 && code <= 57 /* 0-9 */\r\n}\r\n","import {isAlphabetical} from 'is-alphabetical'\r\nimport {isDecimal} from 'is-decimal'\r\n\r\n/**\r\n * Check if the given character code, or the character code at the first\r\n * character, is alphanumerical.\r\n *\r\n * @param {string|number} character\r\n * @returns {boolean} Whether `character` is alphanumerical.\r\n */\r\nexport function isAlphanumerical(character) {\r\n  return isAlphabetical(character) || isDecimal(character)\r\n}\r\n","export var regular = [\r\n  'art-lojban',\r\n  'cel-gaulish',\r\n  'no-bok',\r\n  'no-nyn',\r\n  'zh-guoyu',\r\n  'zh-hakka',\r\n  'zh-min',\r\n  'zh-min-nan',\r\n  'zh-xiang'\r\n]\r\n","export var normal = {\r\n  'en-gb-oed': 'en-GB-oxendict',\r\n  'i-ami': 'ami',\r\n  'i-bnn': 'bnn',\r\n  'i-default': null,\r\n  'i-enochian': null,\r\n  'i-hak': 'hak',\r\n  'i-klingon': 'tlh',\r\n  'i-lux': 'lb',\r\n  'i-mingo': null,\r\n  'i-navajo': 'nv',\r\n  'i-pwn': 'pwn',\r\n  'i-tao': 'tao',\r\n  'i-tay': 'tay',\r\n  'i-tsu': 'tsu',\r\n  'sgn-be-fr': 'sfb',\r\n  'sgn-be-nl': 'vgt',\r\n  'sgn-ch-de': 'sgg',\r\n  'art-lojban': 'jbo',\r\n  'cel-gaulish': null,\r\n  'no-bok': 'nb',\r\n  'no-nyn': 'nn',\r\n  'zh-guoyu': 'cmn',\r\n  'zh-hakka': 'hak',\r\n  'zh-min': null,\r\n  'zh-min-nan': 'nan',\r\n  'zh-xiang': 'hsn'\r\n}\r\n","import {isAlphanumerical} from 'is-alphanumerical'\r\nimport {isAlphabetical} from 'is-alphabetical'\r\nimport {isDecimal} from 'is-decimal'\r\nimport {regular} from './regular.js'\r\nimport {normal} from './normal.js'\r\n\r\nvar own = {}.hasOwnProperty\r\n\r\n/**\r\n * @typedef {Object} ParseOptions\r\n * @property {boolean} [normalize=true]\r\n * @property {boolean} [forgiving=false]\r\n * @property {(reason: string, code: number, offset: number) => void} [warning]\r\n *\r\n * @typedef {Object} Extension\r\n * @property {string} singleton\r\n * @property {Array.<string>} extensions\r\n *\r\n * @typedef {Object} Schema\r\n * @property {string|null} language\r\n * @property {Array.<string>} extendedLanguageSubtags\r\n * @property {string|null} script\r\n * @property {string|null} region\r\n * @property {Array.<string>} variants\r\n * @property {Array.<Extension>} extensions\r\n * @property {Array.<string>} privateuse\r\n * @property {string|null} irregular\r\n * @property {string|null} regular\r\n */\r\n\r\n/**\r\n * Parse a BCP 47 language tag.\r\n *\r\n * @param {string} tag\r\n * @param {ParseOptions} [options]\r\n * @returns {Schema}\r\n */\r\nexport function parse(tag, options) {\r\n  var settings = options || {}\r\n  var result = empty()\r\n  var source = String(tag)\r\n  var value = source.toLowerCase()\r\n  var index = 0\r\n  /** @type {number} */\r\n  var start\r\n  /** @type {number} */\r\n  var groups\r\n  /** @type {number} */\r\n  var offset\r\n\r\n  // Check input.\r\n  if (tag === null || tag === undefined) {\r\n    throw new Error('Expected string, got `' + tag + '`')\r\n  }\r\n\r\n  // Let’s start.\r\n  // First: the edge cases.\r\n  if (own.call(normal, value)) {\r\n    if (\r\n      (settings.normalize === undefined ||\r\n        settings.normalize === null ||\r\n        settings.normalize) &&\r\n      normal[value]\r\n    ) {\r\n      return parse(normal[value])\r\n    }\r\n\r\n    result[regular.includes(value) ? 'regular' : 'irregular'] = source\r\n\r\n    return result\r\n  }\r\n\r\n  // Now, to actually parse, eat what could be a language.\r\n  while (isAlphabetical(value.charCodeAt(index)) && index < 9) index++\r\n\r\n  // A language.\r\n  if (index > 1 /* Min 639. */ && index < 9 /* Max subtag. */) {\r\n    // 5 and up is a subtag.\r\n    // 4 is the size of reserved languages.\r\n    // 3 an ISO 639-2 or ISO 639-3.\r\n    // 2 is an ISO 639-1.\r\n    // <https://github.com/wooorm/iso-639-2>\r\n    // <https://github.com/wooorm/iso-639-3>\r\n    result.language = source.slice(0, index)\r\n\r\n    if (index < 4 /* Max 639. */) {\r\n      groups = 0\r\n\r\n      while (\r\n        value.charCodeAt(index) === 45 /* `-` */ &&\r\n        isAlphabetical(value.charCodeAt(index + 1)) &&\r\n        isAlphabetical(value.charCodeAt(index + 2)) &&\r\n        isAlphabetical(value.charCodeAt(index + 3)) &&\r\n        !isAlphabetical(value.charCodeAt(index + 4))\r\n      ) {\r\n        if (groups > 2 /* Max extended language subtag count. */) {\r\n          return fail(\r\n            index,\r\n            3,\r\n            'Too many extended language subtags, expected at most 3 subtags'\r\n          )\r\n        }\r\n\r\n        // Extended language subtag.\r\n        result.extendedLanguageSubtags.push(source.slice(index + 1, index + 4))\r\n        index += 4\r\n        groups++\r\n      }\r\n    }\r\n\r\n    // ISO 15924 script.\r\n    // <https://github.com/wooorm/iso-15924>\r\n    if (\r\n      value.charCodeAt(index) === 45 /* `-` */ &&\r\n      isAlphabetical(value.charCodeAt(index + 1)) &&\r\n      isAlphabetical(value.charCodeAt(index + 2)) &&\r\n      isAlphabetical(value.charCodeAt(index + 3)) &&\r\n      isAlphabetical(value.charCodeAt(index + 4)) &&\r\n      !isAlphabetical(value.charCodeAt(index + 5))\r\n    ) {\r\n      result.script = source.slice(index + 1, index + 5)\r\n      index += 5\r\n    }\r\n\r\n    if (value.charCodeAt(index) === 45 /* `-` */) {\r\n      // ISO 3166-1 region.\r\n      // <https://github.com/wooorm/iso-3166>\r\n      if (\r\n        isAlphabetical(value.charCodeAt(index + 1)) &&\r\n        isAlphabetical(value.charCodeAt(index + 2)) &&\r\n        !isAlphabetical(value.charCodeAt(index + 3))\r\n      ) {\r\n        result.region = source.slice(index + 1, index + 3)\r\n        index += 3\r\n      }\r\n      // UN M49 region.\r\n      // <https://github.com/wooorm/un-m49>\r\n      else if (\r\n        isDecimal(value.charCodeAt(index + 1)) &&\r\n        isDecimal(value.charCodeAt(index + 2)) &&\r\n        isDecimal(value.charCodeAt(index + 3)) &&\r\n        !isDecimal(value.charCodeAt(index + 4))\r\n      ) {\r\n        result.region = source.slice(index + 1, index + 4)\r\n        index += 4\r\n      }\r\n    }\r\n\r\n    while (value.charCodeAt(index) === 45 /* `-` */) {\r\n      start = index + 1\r\n      offset = start\r\n\r\n      while (isAlphanumerical(value.charCodeAt(offset))) {\r\n        if (offset - start > 7 /* Max variant. */) {\r\n          return fail(\r\n            offset,\r\n            1,\r\n            'Too long variant, expected at most 8 characters'\r\n          )\r\n        }\r\n\r\n        offset++\r\n      }\r\n\r\n      if (\r\n        // Long variant.\r\n        offset - start > 4 /* Min alpha numeric variant. */ ||\r\n        // Short variant.\r\n        (offset - start > 3 /* Min variant. */ &&\r\n          isDecimal(value.charCodeAt(start)))\r\n      ) {\r\n        result.variants.push(source.slice(start, offset))\r\n        index = offset\r\n      }\r\n      // Something else.\r\n      else {\r\n        break\r\n      }\r\n    }\r\n\r\n    // Extensions.\r\n    while (value.charCodeAt(index) === 45 /* `-` */) {\r\n      // Exit if this isn’t an extension.\r\n      if (\r\n        value.charCodeAt(index + 1) === 120 /* `x` */ ||\r\n        !isAlphanumerical(value.charCodeAt(index + 1)) ||\r\n        value.charCodeAt(index + 2) !== 45 /* `-` */ ||\r\n        !isAlphanumerical(value.charCodeAt(index + 3))\r\n      ) {\r\n        break\r\n      }\r\n\r\n      offset = index + 2\r\n      groups = 0\r\n\r\n      while (\r\n        value.charCodeAt(offset) === 45 /* `-` */ &&\r\n        isAlphanumerical(value.charCodeAt(offset + 1)) &&\r\n        isAlphanumerical(value.charCodeAt(offset + 2))\r\n      ) {\r\n        start = offset + 1\r\n        offset = start + 2\r\n        groups++\r\n\r\n        while (isAlphanumerical(value.charCodeAt(offset))) {\r\n          if (offset - start > 7 /* Max extension. */) {\r\n            return fail(\r\n              offset,\r\n              2,\r\n              'Too long extension, expected at most 8 characters'\r\n            )\r\n          }\r\n\r\n          offset++\r\n        }\r\n      }\r\n\r\n      if (!groups) {\r\n        return fail(\r\n          offset,\r\n          4,\r\n          'Empty extension, extensions must have at least 2 characters of content'\r\n        )\r\n      }\r\n\r\n      result.extensions.push({\r\n        singleton: source.charAt(index + 1),\r\n        extensions: source.slice(index + 3, offset).split('-')\r\n      })\r\n\r\n      index = offset\r\n    }\r\n  }\r\n  // Not a language.\r\n  else {\r\n    index = 0\r\n  }\r\n\r\n  // Private use.\r\n  if (\r\n    (index === 0 && value.charCodeAt(index) === 120) /* `x` */ ||\r\n    (value.charCodeAt(index) === 45 /* `-` */ &&\r\n      value.charCodeAt(index + 1) === 120) /* `x` */\r\n  ) {\r\n    index = index ? index + 2 : 1\r\n    offset = index\r\n\r\n    while (\r\n      value.charCodeAt(offset) === 45 /* `-` */ &&\r\n      isAlphanumerical(value.charCodeAt(offset + 1))\r\n    ) {\r\n      start = index + 1\r\n      offset = start\r\n\r\n      while (isAlphanumerical(value.charCodeAt(offset))) {\r\n        if (offset - start > 7 /* Max private use. */) {\r\n          return fail(\r\n            offset,\r\n            5,\r\n            'Too long private-use area, expected at most 8 characters'\r\n          )\r\n        }\r\n\r\n        offset++\r\n      }\r\n\r\n      result.privateuse.push(source.slice(index + 1, offset))\r\n      index = offset\r\n    }\r\n  }\r\n\r\n  if (index !== source.length) {\r\n    return fail(index, 6, 'Found superfluous content after tag')\r\n  }\r\n\r\n  return result\r\n\r\n  /**\r\n   * Create an empty results object.\r\n   *\r\n   * @param {number} offset\r\n   * @param {number} code\r\n   * @param {string} reason\r\n   * @returns {Schema}\r\n   */\r\n  function fail(offset, code, reason) {\r\n    if (settings.warning) settings.warning(reason, code, offset)\r\n    return settings.forgiving ? result : empty()\r\n  }\r\n}\r\n\r\n/**\r\n * Create an empty results object.\r\n *\r\n * @returns {Schema}\r\n */\r\nfunction empty() {\r\n  return {\r\n    language: null,\r\n    extendedLanguageSubtags: [],\r\n    script: null,\r\n    region: null,\r\n    variants: [],\r\n    extensions: [],\r\n    privateuse: [],\r\n    irregular: null,\r\n    regular: null\r\n  }\r\n}\r\n","// load setting from chrome storage\r\n\r\nimport { parse } from \"bcp-47\";\r\n\r\nvar defaultList = {\r\n  useTooltip: \"true\",\r\n  useTTS: \"false\",\r\n  translateWhen: \"mouseoverselect\",\r\n  translateSource: \"auto\",\r\n  translateTarget: getLang(),\r\n  translatorVendor: \"google\",\r\n  keyDownTooltip: \"null\",\r\n  keyDownTTS: \"null\",\r\n  detectType: \"sentence\",\r\n  translateReverseTarget: \"null\",\r\n  tooltipFontSize: \"14\",\r\n  tooltipWidth: \"200\",\r\n  detectPDF: \"true\",\r\n  useOCR: \"false\",\r\n  ocrDetectionLang: \"jpn_vert\",\r\n  historyList: [],\r\n  historyRecordActions: [],\r\n};\r\n\r\nexport function getSettingFromStorage() {\r\n  return new Promise((resolve, reject) => {\r\n    chrome.storage.local.get(Object.keys(defaultList), function(loadedSetting) {\r\n      //load setting\r\n      var currentSetting = {};\r\n      for (var key in defaultList) {\r\n        if (loadedSetting[key]) {\r\n          //if value exist, load. else load defualt val\r\n          currentSetting[key] = loadedSetting[key];\r\n        } else {\r\n          currentSetting[key] = defaultList[key];\r\n        }\r\n      }\r\n      resolve(currentSetting);\r\n    });\r\n  });\r\n}\r\n\r\nfunction getLang() {\r\n  var lang = parse(navigator.language).language;\r\n  lang = lang == \"zh\" ? navigator.language : lang; // chinese lang code fix\r\n  return lang;\r\n}\r\n","\"use strict\";\r\n\r\n//handle translation, setting and pdf\r\n//it communicate with popup.js(for setting) and contentScript.js(for translattion and tts)\r\n//for setting, it save and load from chrome storage\r\n//for translation, use fetch to get translated  result\r\n\r\n//tooltip background===========================================================================\r\nimport { getSettingFromStorage } from \"./setting\";\r\n\r\nvar currentSetting = {};\r\nvar settingLoaded = false;\r\nvar bingLangCode = {\r\n  auto: \"auto-detect\",\r\n  af: \"af\",\r\n  am: \"am\",\r\n  ar: \"ar\",\r\n  az: \"az\",\r\n  bg: \"bg\",\r\n  bs: \"bs\",\r\n  ca: \"ca\",\r\n  cs: \"cs\",\r\n  cy: \"cy\",\r\n  da: \"da\",\r\n  de: \"de\",\r\n  el: \"el\",\r\n  en: \"en\",\r\n  es: \"es\",\r\n  et: \"et\",\r\n  fa: \"fa\",\r\n  fi: \"fi\",\r\n  fr: \"fr\",\r\n  ga: \"ga\",\r\n  gu: \"gu\",\r\n  hi: \"hi\",\r\n  hmn: \"mww\",\r\n  hr: \"hr\",\r\n  ht: \"ht\",\r\n  hu: \"hu\",\r\n  hy: \"hy\",\r\n  id: \"id\",\r\n  is: \"is\",\r\n  it: \"it\",\r\n  iw: \"he\",\r\n  ja: \"ja\",\r\n  kk: \"kk\",\r\n  km: \"km\",\r\n  kn: \"kn\",\r\n  ko: \"ko\",\r\n  ku: \"ku\",\r\n  lo: \"lo\",\r\n  lt: \"lt\",\r\n  lv: \"lv\",\r\n  mg: \"mg\",\r\n  mi: \"mi\",\r\n  ml: \"ml\",\r\n  mr: \"mr\",\r\n  ms: \"ms\",\r\n  mt: \"mt\",\r\n  my: \"my\",\r\n  ne: \"ne\",\r\n  nl: \"nl\",\r\n  no: \"nb\",\r\n  pa: \"pa\",\r\n  pl: \"pl\",\r\n  ps: \"ps\",\r\n  pt: \"pt\",\r\n  ro: \"ro\",\r\n  ru: \"ru\",\r\n  sk: \"sk\",\r\n  sl: \"sl\",\r\n  sm: \"sm\",\r\n  sq: \"sq\",\r\n  sr: \"sr-Cyrl\",\r\n  sv: \"sv\",\r\n  sw: \"sw\",\r\n  ta: \"ta\",\r\n  te: \"te\",\r\n  th: \"th\",\r\n  tl: \"fil\",\r\n  tr: \"tr\",\r\n  uk: \"uk\",\r\n  ur: \"ur\",\r\n  vi: \"vi\",\r\n  \"zh-CN\": \"zh-Hans\",\r\n  \"zh-TW\": \"zh-Hant\",\r\n};\r\n\r\nfunction swap(json) {\r\n  var ret = {};\r\n  for (var key in json) {\r\n    ret[json[key]] = key;\r\n  }\r\n  return ret;\r\n}\r\n\r\nvar bingLangCodeOpposite = swap(bingLangCode); // swap key value\r\ngetSetting();\r\n\r\n//listen from contents js and background js =========================================================================================================\r\nchrome.runtime.onMessage.addListener(function(request, sender, sendResponse) {\r\n  (async () => {\r\n    if (settingLoaded == false) {\r\n      await getSetting();\r\n    }\r\n\r\n    if (request.type === \"translate\") {\r\n      doTranslate(request, sendResponse);\r\n    } else if (request.type === \"tts\") {\r\n      doTts(request.word, request.lang);\r\n      sendResponse({});\r\n    } else if (request.type === \"stopTTS\") {\r\n      chrome.tts.stop();\r\n      sendResponse({});\r\n    } else if (request.type === \"saveSetting\") {\r\n      saveSetting(request.options);\r\n      sendResponse({});\r\n    } else if (request.type === \"recordHistory\") {\r\n      recordHistory(request);\r\n      sendResponse({});\r\n    }\r\n  })();\r\n\r\n  return true;\r\n});\r\n\r\nfunction saveSetting(inputSettings) {\r\n  chrome.storage.local.set(inputSettings, function() {\r\n    currentSetting = inputSettings;\r\n  });\r\n}\r\n\r\nasync function getSetting() {\r\n  //load  setting from background js\r\n  currentSetting = await getSettingFromStorage();\r\n  settingLoaded = true;\r\n}\r\n\r\nfunction recordHistory(request) {\r\n  //append history to front\r\n  currentSetting[\"historyList\"].unshift({\r\n    sourceText: request.sourceText,\r\n    targetText: request.targetText,\r\n  });\r\n  //remove when too many list\r\n  if (currentSetting[\"historyList\"].length > 100) {\r\n    currentSetting[\"historyList\"].pop();\r\n  }\r\n  saveSetting(currentSetting);\r\n}\r\n\r\n// translate ===========================================================\r\nlet bingAccessToken;\r\nlet googleBaseUrl =\r\n  \"https://clients5.google.com/translate_a/single?dj=1&dt=t&dt=sp&dt=ld&dt=bd&client=dict-chrome-ex&\";\r\nlet bingBaseUrl = \"https://www.bing.com/ttranslatev3?isVertical=1\\u0026&\";\r\n\r\nasync function doTranslate(request, sendResponse) {\r\n  try {\r\n    if (currentSetting[\"translatorVendor\"] == \"google\") {\r\n      var { translatedText, detectedLang } = await translateWithGoogle(\r\n        request.word,\r\n        request.translateTarget\r\n      );\r\n    } else {\r\n      var { translatedText, detectedLang } = await translateWithBing(\r\n        request.word,\r\n        request.translateTarget\r\n      );\r\n    }\r\n\r\n    sendResponse({\r\n      translatedText: translatedText,\r\n      sourceLang: detectedLang,\r\n      targetLang: request.translateTarget,\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    sendResponse({\r\n      translatedText: \"\",\r\n      sourceLang: \"en\",\r\n      targetLang: request.translateTarget,\r\n    });\r\n  }\r\n}\r\n\r\nasync function translateWithGoogle(word, targetLang) {\r\n  let res = await postMessage(googleBaseUrl, {\r\n    q: word,\r\n    sl: currentSetting[\"translateSource\"], //source lang\r\n    tl: targetLang,\r\n  });\r\n\r\n  if (res && res.sentences) {\r\n    var translatedText = \"\";\r\n    res.sentences.forEach(function(sentences) {\r\n      if (sentences.trans) {\r\n        translatedText += sentences.trans;\r\n      }\r\n    });\r\n    var detectedLang = res.src;\r\n    return { translatedText, detectedLang };\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\nasync function translateWithBing(word, targetLang) {\r\n  const { token, key, IG, IID } = await getBingAccessToken();\r\n\r\n  let res = await postMessage(bingBaseUrl, {\r\n    text: word,\r\n    fromLang: bingLangCode[currentSetting[\"translateSource\"]],\r\n    to: bingLangCode[targetLang],\r\n    token,\r\n    key,\r\n    IG,\r\n    IID: IID && IID.length ? IID + \".\" + bingAccessToken.count++ : \"\",\r\n  });\r\n  if (res && res[0]) {\r\n    var detectedLang =\r\n      bingLangCodeOpposite[res[0][\"detectedLanguage\"][\"language\"]];\r\n    var translatedText = res[0][\"translations\"][0][\"text\"];\r\n    return { translatedText, detectedLang };\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\nasync function postMessage(url, params) {\r\n  return await fetch(url + new URLSearchParams(params), {\r\n    method: \"POST\",\r\n  })\r\n    .then((response) => response.json())\r\n    .catch((err) => console.log(err));\r\n}\r\n\r\nasync function getBingAccessToken() {\r\n  // https://github.com/plainheart/bing-translate-api/blob/dd0319e1046d925fa4cd4850e2323c5932de837a/src/index.js#L42\r\n  try {\r\n    //if no access token or token is timeout, get new token\r\n    if (\r\n      !bingAccessToken ||\r\n      Date.now() - bingAccessToken[\"tokenTs\"] >\r\n        bingAccessToken[\"tokenExpiryInterval\"]\r\n    ) {\r\n      const data = await fetch(\r\n        \"https://www.bing.com/translator\"\r\n      ).then((response) => response.text());\r\n      const IG = data.match(/IG:\"([^\"]+)\"/)[1];\r\n      const IID = data.match(/data-iid=\"([^\"]+)\"/)[1];\r\n      const [_key, _token, interval, _isVertical, _isAuthv2] = JSON.parse(\r\n        data.match(/params_RichTranslateHelper\\s?=\\s?([^\\]]+\\])/)[1]\r\n      );\r\n      bingAccessToken = {\r\n        IG,\r\n        IID,\r\n        key: _key,\r\n        token: _token,\r\n        tokenTs: _key,\r\n        tokenExpiryInterval: interval,\r\n        isAuthv2: undefined,\r\n        count: 0,\r\n      };\r\n    }\r\n    return bingAccessToken;\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n}\r\n\r\n//tts =========================================================================================\r\n\r\nvar voiceList = {};\r\n\r\nasync function doTts(word, lang) {\r\n  var voice = await getVoices(lang);\r\n  chrome.tts.speak(word, {\r\n    lang: lang,\r\n    voiceName: voice,\r\n  });\r\n}\r\n\r\nfunction getVoices(lang) {\r\n  return new Promise((resolve) => {\r\n    //if already have voiceName return\r\n    if (voiceList[lang]) {\r\n      resolve(voiceList[lang]);\r\n    } else {\r\n      // get voice list and sort by remote first\r\n      // get matched lang voice\r\n      chrome.tts.getVoices((voices) => {\r\n        let filtered = voices.filter((e) => {\r\n          return e.remote != null && e.lang != null && e.voiceName != null;\r\n        }); //get one that include remote, lang, voiceName\r\n\r\n        filtered.sort((x, y) => {\r\n          return y.remote - x.remote;\r\n        }); //get remote first;\r\n\r\n        //find matched lang voice and speak\r\n        for (var item of filtered) {\r\n          if (item.lang.toLowerCase().includes(lang.toLowerCase())) {\r\n            voiceList[lang] = item.voiceName;\r\n            resolve(voiceList[lang]);\r\n            break;\r\n          }\r\n        }\r\n      });\r\n    }\r\n  });\r\n}\r\n"],"sourceRoot":""}