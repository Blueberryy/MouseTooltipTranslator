!function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=23)}({1:function(t,e,n){"use strict";function a(t){var e="string"==typeof t?t.charCodeAt(0):t;return e>=97&&e<=122||e>=65&&e<=90}function r(t){var e="string"==typeof t?t.charCodeAt(0):t;return e>=48&&e<=57}function o(t){return a(t)||r(t)}n.d(e,"a",(function(){return d}));var s=["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"],i={"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"},l={}.hasOwnProperty;var c,u={useTooltip:"true",useTTS:"false",translateWhen:"mouseoverselect",translateSource:"auto",translateTarget:(c=function t(e,n){var c,u,d,g=n||{},h={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},f=String(e),m=f.toLowerCase(),p=0;if(null==e)throw new Error("Expected string, got `"+e+"`");if(l.call(i,m))return(void 0===g.normalize||null===g.normalize||g.normalize)&&i[m]?t(i[m]):(h[s.includes(m)?"regular":"irregular"]=f,h);for(;a(m.charCodeAt(p))&&p<9;)p++;if(p>1&&p<9){if(h.language=f.slice(0,p),p<4)for(u=0;45===m.charCodeAt(p)&&a(m.charCodeAt(p+1))&&a(m.charCodeAt(p+2))&&a(m.charCodeAt(p+3))&&!a(m.charCodeAt(p+4));){if(u>2)return v(p,3,"Too many extended language subtags, expected at most 3 subtags");h.extendedLanguageSubtags.push(f.slice(p+1,p+4)),p+=4,u++}for(45===m.charCodeAt(p)&&a(m.charCodeAt(p+1))&&a(m.charCodeAt(p+2))&&a(m.charCodeAt(p+3))&&a(m.charCodeAt(p+4))&&!a(m.charCodeAt(p+5))&&(h.script=f.slice(p+1,p+5),p+=5),45===m.charCodeAt(p)&&(a(m.charCodeAt(p+1))&&a(m.charCodeAt(p+2))&&!a(m.charCodeAt(p+3))?(h.region=f.slice(p+1,p+3),p+=3):r(m.charCodeAt(p+1))&&r(m.charCodeAt(p+2))&&r(m.charCodeAt(p+3))&&!r(m.charCodeAt(p+4))&&(h.region=f.slice(p+1,p+4),p+=4));45===m.charCodeAt(p);){for(d=c=p+1;o(m.charCodeAt(d));){if(d-c>7)return v(d,1,"Too long variant, expected at most 8 characters");d++}if(!(d-c>4||d-c>3&&r(m.charCodeAt(c))))break;h.variants.push(f.slice(c,d)),p=d}for(;45===m.charCodeAt(p)&&120!==m.charCodeAt(p+1)&&o(m.charCodeAt(p+1))&&45===m.charCodeAt(p+2)&&o(m.charCodeAt(p+3));){for(d=p+2,u=0;45===m.charCodeAt(d)&&o(m.charCodeAt(d+1))&&o(m.charCodeAt(d+2));)for(d=(c=d+1)+2,u++;o(m.charCodeAt(d));){if(d-c>7)return v(d,2,"Too long extension, expected at most 8 characters");d++}if(!u)return v(d,4,"Empty extension, extensions must have at least 2 characters of content");h.extensions.push({singleton:f.charAt(p+1),extensions:f.slice(p+3,d).split("-")}),p=d}}else p=0;if(0===p&&120===m.charCodeAt(p)||45===m.charCodeAt(p)&&120===m.charCodeAt(p+1))for(d=p=p?p+2:1;45===m.charCodeAt(d)&&o(m.charCodeAt(d+1));){for(d=c=p+1;o(m.charCodeAt(d));){if(d-c>7)return v(d,5,"Too long private-use area, expected at most 8 characters");d++}h.privateuse.push(f.slice(p+1,d)),p=d}return p!==f.length?v(p,6,"Found superfluous content after tag"):h;function v(t,e,n){return g.warning&&g.warning(n,e,t),g.forgiving?h:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}}(navigator.language).language,c="zh"==c?navigator.language:c),translatorVendor:"google",keyDownTooltip:"null",keyDownTTS:"null",detectType:"sentence",translateReverseTarget:"null",tooltipFontSize:"14",tooltipWidth:"200",detectPDF:"true",useOCR:"false",ocrDetectionLang:"jpn_vert",historyList:[],historyRecordActions:[]};function d(){return new Promise((t,e)=>{chrome.storage.local.get(Object.keys(u),(function(e){var n={};for(var a in u)e[a]?n[a]=e[a]:n[a]=u[a];t(n)}))})}},23:function(t,e,n){"use strict";n.r(e);var a=n(1),r={},o=!1,s={auto:"auto-detect",af:"af",am:"am",ar:"ar",az:"az",bg:"bg",bs:"bs",ca:"ca",cs:"cs",cy:"cy",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fr:"fr",ga:"ga",gu:"gu",hi:"hi",hmn:"mww",hr:"hr",ht:"ht",hu:"hu",hy:"hy",id:"id",is:"is",it:"it",iw:"he",ja:"ja",kk:"kk",km:"km",kn:"kn",ko:"ko",ku:"ku",lo:"lo",lt:"lt",lv:"lv",mg:"mg",mi:"mi",ml:"ml",mr:"mr",ms:"ms",mt:"mt",my:"my",ne:"ne",nl:"nl",no:"nb",pa:"pa",pl:"pl",ps:"ps",pt:"pt",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sm:"sm",sq:"sq",sr:"sr-Cyrl",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tl:"fil",tr:"tr",uk:"uk",ur:"ur",vi:"vi","zh-CN":"zh-Hans","zh-TW":"zh-Hant"};var i=function(t){var e={};for(var n in t)e[t[n]]=n;return e}(s);function l(t){chrome.storage.local.set(t,(function(){r=t}))}async function c(){r=await Object(a.a)(),o=!0}let u;c(),chrome.runtime.onMessage.addListener((function(t,e,n){return(async()=>{0==o&&await c(),"translate"===t.type?async function(t,e){try{if("google"==r.translatorVendor)var{translatedText:n,detectedLang:a}=await async function(t,e){var n=d;Date.now()<h&&(n=g);var a=await f(n,t,e);return null==a&&n==d?(h=Date.now()+36e5,await f(g,t,e)):a}(t.word,t.translateTarget);else var{translatedText:n,detectedLang:a}=await async function(t,e){const{token:n,key:a,IG:o,IID:l}=await async function(){try{if(!u||Date.now()-u.tokenTs>u.tokenExpiryInterval){const t=await fetch("https://www.bing.com/translator").then(t=>t.text()),e=t.match(/IG:"([^"]+)"/)[1],n=t.match(/data-iid="([^"]+)"/)[1],[a,r,o,s,i]=JSON.parse(t.match(/params_RichTranslateHelper\s?=\s?([^\]]+\])/)[1]);u={IG:e,IID:n,key:a,token:r,tokenTs:a,tokenExpiryInterval:o,isAuthv2:void 0,count:0}}return u}catch(t){console.log(t)}}();let c=await m("https://www.bing.com/ttranslatev3?isVertical=1&&",{text:t,fromLang:s[r.translateSource],to:s[e],token:n,key:a,IG:o,IID:l&&l.length?l+"."+u.count++:""});if(c&&c[0]){var d=i[c[0].detectedLanguage.language];return{translatedText:c[0].translations[0].text,detectedLang:d}}return null}(t.word,t.translateTarget);e({translatedText:n,sourceLang:a,targetLang:t.translateTarget})}catch(n){console.log(n),e({translatedText:"",sourceLang:"en",targetLang:t.translateTarget})}}(t,n):"tts"===t.type?(!async function(t,e){var n=await function(t){return new Promise(e=>{p[t]?e(p[t]):chrome.tts.getVoices(n=>{let a=n.filter(t=>null!=t.remote&&null!=t.lang&&null!=t.voiceName);for(var r of(a.sort((t,e)=>e.remote-t.remote),a))if(r.lang.toLowerCase().includes(t.toLowerCase())){p[t]=r.voiceName,e(p[t]);break}})})}(e);chrome.tts.speak(t,{lang:e,voiceName:n})}(t.word,t.lang),n({})):"stopTTS"===t.type?(chrome.tts.stop(),n({})):"saveSetting"===t.type?(l(t.options),n({})):"recordHistory"===t.type&&(!function(t){r.historyList.unshift({sourceText:t.sourceText,targetText:t.targetText}),r.historyList.length>100&&r.historyList.pop();l(r)}(t),n({}))})(),!0}));let d="https://translate.googleapis.com/translate_a/single?dt=at&dt=bd&dt=ex&dt=ld&client=gtx&dt=md&dt=qca&dt=rw&dt=rm&dt=ss&dt=t&ie=UTF-8&oe=UTF-8&otf=1&ssel=0&tsel=0&kc=7&dj=1&",g="https://clients5.google.com/translate_a/single?dj=1&dt=t&dt=sp&dt=ld&dt=bd&client=dict-chrome-ex&";var h=0;async function f(t,e,n){let a=await m(t,{q:e,sl:r.translateSource,tl:n});if(a&&a.sentences){var o="";a.sentences.forEach((function(t){t.trans&&(o+=t.trans)}));var s=a.src;return{translatedText:o,detectedLang:s}}return null}async function m(t,e){return await fetch(t+new URLSearchParams(e),{method:"POST"}).then(t=>t.json()).catch(t=>console.log(t))}var p={}}});
//# sourceMappingURL=background.js.map