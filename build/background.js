!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=23)}({1:function(e,t,r){"use strict";function n(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90}function a(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=48&&t<=57}function o(e){return n(e)||a(e)}r.d(t,"a",(function(){return u}));var s=["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"],i={"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"},l={}.hasOwnProperty;var c={useTooltip:"true",useTTS:"false",translateWhen:"mouseoverselect",translateSource:"auto",translateTarget:function e(t,r){var c,u,h,g=r||{},d={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},f=String(t),m=f.toLowerCase(),p=0;if(null==t)throw new Error("Expected string, got `"+t+"`");if(l.call(i,m))return(void 0===g.normalize||null===g.normalize||g.normalize)&&i[m]?e(i[m]):(d[s.includes(m)?"regular":"irregular"]=f,d);for(;n(m.charCodeAt(p))&&p<9;)p++;if(p>1&&p<9){if(d.language=f.slice(0,p),p<4)for(u=0;45===m.charCodeAt(p)&&n(m.charCodeAt(p+1))&&n(m.charCodeAt(p+2))&&n(m.charCodeAt(p+3))&&!n(m.charCodeAt(p+4));){if(u>2)return y(p,3,"Too many extended language subtags, expected at most 3 subtags");d.extendedLanguageSubtags.push(f.slice(p+1,p+4)),p+=4,u++}for(45===m.charCodeAt(p)&&n(m.charCodeAt(p+1))&&n(m.charCodeAt(p+2))&&n(m.charCodeAt(p+3))&&n(m.charCodeAt(p+4))&&!n(m.charCodeAt(p+5))&&(d.script=f.slice(p+1,p+5),p+=5),45===m.charCodeAt(p)&&(n(m.charCodeAt(p+1))&&n(m.charCodeAt(p+2))&&!n(m.charCodeAt(p+3))?(d.region=f.slice(p+1,p+3),p+=3):a(m.charCodeAt(p+1))&&a(m.charCodeAt(p+2))&&a(m.charCodeAt(p+3))&&!a(m.charCodeAt(p+4))&&(d.region=f.slice(p+1,p+4),p+=4));45===m.charCodeAt(p);){for(h=c=p+1;o(m.charCodeAt(h));){if(h-c>7)return y(h,1,"Too long variant, expected at most 8 characters");h++}if(!(h-c>4||h-c>3&&a(m.charCodeAt(c))))break;d.variants.push(f.slice(c,h)),p=h}for(;45===m.charCodeAt(p)&&120!==m.charCodeAt(p+1)&&o(m.charCodeAt(p+1))&&45===m.charCodeAt(p+2)&&o(m.charCodeAt(p+3));){for(h=p+2,u=0;45===m.charCodeAt(h)&&o(m.charCodeAt(h+1))&&o(m.charCodeAt(h+2));)for(h=(c=h+1)+2,u++;o(m.charCodeAt(h));){if(h-c>7)return y(h,2,"Too long extension, expected at most 8 characters");h++}if(!u)return y(h,4,"Empty extension, extensions must have at least 2 characters of content");d.extensions.push({singleton:f.charAt(p+1),extensions:f.slice(p+3,h).split("-")}),p=h}}else p=0;if(0===p&&120===m.charCodeAt(p)||45===m.charCodeAt(p)&&120===m.charCodeAt(p+1))for(h=p=p?p+2:1;45===m.charCodeAt(h)&&o(m.charCodeAt(h+1));){for(h=c=p+1;o(m.charCodeAt(h));){if(h-c>7)return y(h,5,"Too long private-use area, expected at most 8 characters");h++}d.privateuse.push(f.slice(p+1,h)),p=h}return p!==f.length?y(p,6,"Found superfluous content after tag"):d;function y(e,t,r){return g.warning&&g.warning(r,t,e),g.forgiving?d:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}}(navigator.language).language,translatorVendor:"google",keyDownTooltip:"null",keyDownTTS:"null",detectType:"sentence",translateReverseTarget:"null",tooltipFontSize:"14",tooltipWidth:"200",useOCR:"false",ocrDetectionLang:"jpn_vert",historyList:[],historyRecordActions:[]};function u(e){return new Promise((t,r)=>{Object.keys(e).length!=Object.keys(c).length?chrome.storage.local.get(Object.keys(c),(function(r){for(var n in c)r[n]?e[n]=r[n]:e[n]=c[n];t(e)})):t(e)})}},23:function(e,t,r){"use strict";r.r(t);var n=r(1),a={},o={auto:"auto-detect",af:"af",am:"am",ar:"ar",az:"az",bg:"bg",bs:"bs",ca:"ca",cs:"cs",cy:"cy",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fr:"fr",ga:"ga",gu:"gu",hi:"hi",hmn:"mww",hr:"hr",ht:"ht",hu:"hu",hy:"hy",id:"id",is:"is",it:"it",iw:"he",ja:"ja",kk:"kk",km:"km",kn:"kn",ko:"ko",ku:"ku",lo:"lo",lt:"lt",lv:"lv",mg:"mg",mi:"mi",ml:"ml",mr:"mr",ms:"ms",mt:"mt",my:"my",ne:"ne",nl:"nl",no:"nb",pa:"pa",pl:"pl",ps:"ps",pt:"pt",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sm:"sm",sq:"sq",sr:"sr-Cyrl",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tl:"fil",tr:"tr",uk:"uk",ur:"ur",vi:"vi","zh-cn":"zh-Hans","zh-tw":"zh-Hant"};var s=function(e){var t={};for(var r in e)t[e[r]]=r;return t}(o);function i(e){chrome.storage.local.set(e,(function(){a=e}))}let l;chrome.runtime.onMessage.addListener((function(e,t,r){return(async()=>{a=await Object(n.a)(a),"translate"===e.type?async function(e,t){var r,n,i="",c="";if("google"==a.translatorVendor)r="https://translate.googleapis.com/translate_a/t?client=dict-chrome-ex&",n={q:e.word,sl:a.translateSource,tl:e.translateTarget};else{(!l||Date.now()-l.tokenTs>l.tokenExpiryInterval)&&(l=await async function(){try{const e=await fetch("https://www.bing.com/translator").then(e=>e.text()),t=e.match(/IG:"([^"]+)"/)[1],r=e.match(/data-iid="([^"]+)"/)[1],[n,a,o,s,i]=JSON.parse(e.match(/params_RichTranslateHelper\s?=\s?([^\]]+\])/)[1]);return{IG:t,IID:r,key:n,token:a,tokenTs:n,tokenExpiryInterval:o,isAuthv2:void 0,count:0}}catch(e){console.log(e)}}()),r="https://www.bing.com/ttranslatev3?isVertical=1&&";const{token:t,key:s,IG:i,IID:c}=l;n={text:e.word,fromLang:o[a.translateSource],to:o[e.translateTarget],token:t,key:s,IG:i,IID:c&&c.length?c+"."+l.count++:""}}try{const o=await fetch(r+new URLSearchParams(n),{method:"POST"}).then(e=>e.json());"google"==a.translatorVendor?(o.sentences&&o.sentences.forEach((function(e){e.trans&&(c+=e.trans)})),i=o.src):(i=s[o[0].detectedLanguage.language],c=o[0].translations[0].text),t({translatedText:c,sourceLang:i,targetLang:e.translateTarget})}catch(r){console.log(r),t({translatedText:"",sourceLang:"en",targetLang:e.translateTarget})}}(e,r):"tts"===e.type?(chrome.tts.getVoices(t=>{let r=t.filter(e=>null!=e.remote&&null!=e.lang&&null!=e.voiceName);for(var n of(r.sort((e,t)=>t.remote-e.remote),r))if(n.lang.toLowerCase().includes(e.lang.toLowerCase())){chrome.tts.speak(e.word,{lang:e.lang,voiceName:n.voiceName});break}}),r({})):"stopTTS"===e.type?(chrome.tts.stop(),r({})):"saveSetting"===e.type?i(e.options):"recordHistory"===e.type&&(a.historyList.unshift({sourceText:e.sourceText,targetText:e.targetText}),a.historyList.length>100&&a.historyList.pop(),i(a))})(),!0})),chrome.webRequest.onHeadersReceived.addListener(({url:e,method:t,responseHeaders:r})=>{const n=r.filter(e=>"content-disposition"===e.name.toLowerCase()).shift();if(n&&n.value.toLowerCase().includes("attachment"))return;const a=r.filter(e=>"content-type"===e.name.toLowerCase()).shift();a&&a.value.toLowerCase().includes("application/pdf")&&chrome.tabs.update({url:chrome.runtime.getURL("/pdfjs/web/viewer.html")+"?file="+e})},{urls:["<all_urls>"],types:["main_frame","sub_frame"]},["responseHeaders"]),chrome.webRequest.onBeforeRequest.addListener((function({url:e,method:t}){chrome.tabs.update({url:chrome.runtime.getURL("/pdfjs/web/viewer.html")+"?file="+e})}),{urls:["file:///*/*.pdf","file:///*/*.PDF"],types:["main_frame"]},[])}});
//# sourceMappingURL=background.js.map